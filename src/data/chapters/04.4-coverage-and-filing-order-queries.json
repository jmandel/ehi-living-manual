[
  {
    "id": "04.4-coverage-and-filing-order-0",
    "originalQuery": "SELECT \n  c.COVERAGE_ID,\n  c.COVERAGE_TYPE_C_NAME as coverage_type,\n  c.PAYOR_ID_PAYOR_NAME as payor_name,\n  c.PLAN_ID_BENEFIT_PLAN_NAME as plan_name,\n  c.GROUP_NAME as employer_group,\n  c.GROUP_NUM as group_number,\n  cm.MEM_NUMBER as member_id,\n  cm.MEM_REL_TO_SUB_C_NAME as relationship,\n  pf.FILING_ORDER\nFROM COVERAGE c\nLEFT JOIN COVERAGE_MEMBER_LIST cm ON c.COVERAGE_ID = cm.COVERAGE_ID\nLEFT JOIN PAT_CVG_FILE_ORDER pf ON c.COVERAGE_ID = pf.COVERAGE_ID\nWHERE cm.PAT_ID = 'Z7004242'\nORDER BY pf.FILING_ORDER;",
    "description": "View a patient's complete insurance picture",
    "chapterId": "04.4-coverage-and-filing-order",
    "index": 0,
    "results": [
      {
        "COVERAGE_ID": 5934765,
        "coverage_type": "Indemnity",
        "payor_name": "BLUE CROSS OF WISCONSIN",
        "plan_name": "BLUE CROSS WI PPO/FEDERAL",
        "employer_group": "Microsoft",
        "group_number": 1000010,
        "member_id": "MSJ60249687901",
        "relationship": "Self",
        "FILING_ORDER": 1
      }
    ],
    "columns": [
      "COVERAGE_ID",
      "coverage_type",
      "payor_name",
      "plan_name",
      "employer_group",
      "group_number",
      "member_id",
      "relationship",
      "FILING_ORDER"
    ],
    "error": null
  },
  {
    "id": "04.4-coverage-and-filing-order-1",
    "originalQuery": "SELECT \n  cm.PAT_ID,\n  p.PAT_NAME,\n  cm.MEM_REL_TO_SUB_C_NAME as relationship,\n  cm.MEM_NUMBER,\n  cm.MEM_EFF_FROM_DATE,\n  cm.MEM_EFF_TO_DATE,\n  cm.MEM_COVERED_YN as currently_covered\nFROM COVERAGE_MEMBER_LIST cm\nJOIN PATIENT p ON cm.PAT_ID = p.PAT_ID\nWHERE cm.COVERAGE_ID = 5934765  -- Our sample coverage\nORDER BY cm.LINE;",
    "description": "Find all family members on the same coverage",
    "chapterId": "04.4-coverage-and-filing-order",
    "index": 1,
    "results": [
      {
        "PAT_ID": "Z7004242",
        "PAT_NAME": "MANDEL,JOSHUA C",
        "relationship": "Self",
        "MEM_NUMBER": "MSJ60249687901",
        "MEM_EFF_FROM_DATE": "8/9/2018 12:00:00 AM",
        "MEM_EFF_TO_DATE": "",
        "currently_covered": "Y"
      }
    ],
    "columns": [
      "PAT_ID",
      "PAT_NAME",
      "relationship",
      "MEM_NUMBER",
      "MEM_EFF_FROM_DATE",
      "MEM_EFF_TO_DATE",
      "currently_covered"
    ],
    "error": null
  },
  {
    "id": "04.4-coverage-and-filing-order-2",
    "originalQuery": "SELECT \n  pf.FILING_ORDER,\n  CASE pf.FILING_ORDER\n    WHEN 1 THEN 'Primary'\n    WHEN 2 THEN 'Secondary'\n    WHEN 3 THEN 'Tertiary'\n    ELSE 'Other'\n  END as filing_position,\n  c.PAYOR_ID_PAYOR_NAME as payor,\n  c.PLAN_ID_BENEFIT_PLAN_NAME as plan,\n  c.CVG_EFF_DT as effective_date,\n  c.CVG_TERM_DT as term_date\nFROM PAT_CVG_FILE_ORDER pf\nJOIN COVERAGE c ON pf.COVERAGE_ID = c.COVERAGE_ID\nWHERE pf.PAT_ID = 'Z7004242'\nORDER BY pf.FILING_ORDER;",
    "description": "See filing order for all of a patient's coverages",
    "chapterId": "04.4-coverage-and-filing-order",
    "index": 2,
    "results": [
      {
        "FILING_ORDER": 1,
        "filing_position": "Primary",
        "payor": "BLUE CROSS OF WISCONSIN",
        "plan": "BLUE CROSS WI PPO/FEDERAL",
        "effective_date": "",
        "term_date": ""
      }
    ],
    "columns": [
      "FILING_ORDER",
      "filing_position",
      "payor",
      "plan",
      "effective_date",
      "term_date"
    ],
    "error": null
  },
  {
    "id": "04.4-coverage-and-filing-order-3",
    "originalQuery": "-- This query would check for Medicare coverage with filing_order > 1\n-- In our sample data, we'll demonstrate the concept\nSELECT \n  c.COVERAGE_ID,\n  c.PAYOR_ID_PAYOR_NAME,\n  pf.FILING_ORDER,\n  p.BIRTH_DATE,\n  -- Calculate age\n  CAST((JULIANDAY('2024-01-01') - JULIANDAY(p.BIRTH_DATE)) / 365.25 AS INT) as age,\n  CASE \n    WHEN c.PAYOR_ID_PAYOR_NAME LIKE '%MEDICARE%' AND pf.FILING_ORDER > 1 \n    THEN 'Medicare Secondary'\n    WHEN c.PAYOR_ID_PAYOR_NAME LIKE '%MEDICARE%' AND pf.FILING_ORDER = 1 \n    THEN 'Medicare Primary'\n    ELSE 'Non-Medicare'\n  END as medicare_position\nFROM COVERAGE c\nJOIN PAT_CVG_FILE_ORDER pf ON c.COVERAGE_ID = pf.COVERAGE_ID\nJOIN PATIENT p ON pf.PAT_ID = p.PAT_ID\nWHERE pf.PAT_ID = 'Z7004242';",
    "description": "Identify potential Medicare secondary payer scenarios",
    "chapterId": "04.4-coverage-and-filing-order",
    "index": 3,
    "results": [
      {
        "COVERAGE_ID": 5934765,
        "PAYOR_ID_PAYOR_NAME": "BLUE CROSS OF WISCONSIN",
        "FILING_ORDER": 1,
        "BIRTH_DATE": "10/26/1982 12:00:00 AM",
        "age": null,
        "medicare_position": "Non-Medicare"
      }
    ],
    "columns": [
      "COVERAGE_ID",
      "PAYOR_ID_PAYOR_NAME",
      "FILING_ORDER",
      "BIRTH_DATE",
      "age",
      "medicare_position"
    ],
    "error": null
  },
  {
    "id": "04.4-coverage-and-filing-order-4",
    "originalQuery": "WITH coverage_timeline AS (\n  SELECT \n    c.COVERAGE_ID,\n    c.PAYOR_ID_PAYOR_NAME as payor,\n    c.PLAN_ID_BENEFIT_PLAN_NAME as plan_name,\n    cm.MEM_EFF_FROM_DATE as start_date,\n    cm.MEM_EFF_TO_DATE as end_date,\n    pf.FILING_ORDER,\n    -- Check if currently active\n    CASE \n      WHEN cm.MEM_EFF_TO_DATE IS NULL OR cm.MEM_EFF_TO_DATE > DATE('now') \n      THEN 'Active'\n      ELSE 'Terminated'\n    END as status\n  FROM COVERAGE c\n  JOIN COVERAGE_MEMBER_LIST cm ON c.COVERAGE_ID = cm.COVERAGE_ID\n  JOIN PAT_CVG_FILE_ORDER pf ON c.COVERAGE_ID = pf.COVERAGE_ID\n  WHERE cm.PAT_ID = 'Z7004242'\n)\nSELECT * FROM coverage_timeline\nORDER BY start_date, FILING_ORDER;",
    "description": "Build a coverage timeline for a patient",
    "chapterId": "04.4-coverage-and-filing-order",
    "index": 4,
    "results": [
      {
        "COVERAGE_ID": 5934765,
        "payor": "BLUE CROSS OF WISCONSIN",
        "plan_name": "BLUE CROSS WI PPO/FEDERAL",
        "start_date": "8/9/2018 12:00:00 AM",
        "end_date": "",
        "FILING_ORDER": 1,
        "status": "Terminated"
      }
    ],
    "columns": [
      "COVERAGE_ID",
      "payor",
      "plan_name",
      "start_date",
      "end_date",
      "FILING_ORDER",
      "status"
    ],
    "error": null
  },
  {
    "id": "04.4-coverage-and-filing-order-5",
    "originalQuery": "SELECT \n  -- Coverage info\n  c.COVERAGE_ID,\n  c.PAYOR_ID_PAYOR_NAME as insurance_company,\n  \n  -- Member (patient) info\n  cm.PAT_ID as member_id,\n  member.PAT_NAME as member_name,\n  cm.MEM_REL_TO_SUB_C_NAME as relationship_to_subscriber,\n  \n  -- Subscriber info\n  COALESCE(c.PAT_REC_OF_SUBS_ID, cm.PAT_ID) as subscriber_id,\n  CASE \n    WHEN cm.MEM_REL_TO_SUB_C_NAME = 'Self' THEN member.PAT_NAME\n    ELSE 'Different Person'\n  END as subscriber_name\n  \nFROM COVERAGE c\nJOIN COVERAGE_MEMBER_LIST cm ON c.COVERAGE_ID = cm.COVERAGE_ID\nJOIN PATIENT member ON cm.PAT_ID = member.PAT_ID\nWHERE cm.COVERAGE_ID = 5934765;",
    "description": "Explore subscriber vs member relationships",
    "chapterId": "04.4-coverage-and-filing-order",
    "index": 5,
    "results": [
      {
        "COVERAGE_ID": 5934765,
        "insurance_company": "BLUE CROSS OF WISCONSIN",
        "member_id": "Z7004242",
        "member_name": "MANDEL,JOSHUA C",
        "relationship_to_subscriber": "Self",
        "subscriber_id": "Z7004242",
        "subscriber_name": "MANDEL,JOSHUA C"
      }
    ],
    "columns": [
      "COVERAGE_ID",
      "insurance_company",
      "member_id",
      "member_name",
      "relationship_to_subscriber",
      "subscriber_id",
      "subscriber_name"
    ],
    "error": null
  },
  {
    "id": "04.4-coverage-and-filing-order-6",
    "originalQuery": "SELECT \n  tx.TX_ID,\n  tx.SERVICE_DATE,\n  tx.PROC_ID,\n  tx.AMOUNT as charge_amount,\n  \n  -- EOB details\n  eob.CVD_AMT as covered_amount,\n  eob.NONCVD_AMT as non_covered,\n  eob.DED_AMT as deductible,\n  eob.COINS_AMT as coinsurance,\n  eob.PAID_AMT as insurance_paid,\n  \n  -- Calculate patient responsibility\n  (eob.DED_AMT + eob.COINS_AMT) as patient_resp\n  \nFROM ARPB_TRANSACTIONS tx\nJOIN PMT_EOB_INFO_I eob ON tx.TX_ID = eob.TX_ID\nWHERE tx.TX_TYPE_C_NAME = 'Charge'\n  AND eob.PAID_AMT IS NOT NULL\nORDER BY tx.SERVICE_DATE DESC\nLIMIT 10;",
    "description": "Analyze EOB payment patterns",
    "chapterId": "04.4-coverage-and-filing-order",
    "index": 6,
    "results": [],
    "columns": [],
    "error": null
  },
  {
    "id": "04.4-coverage-and-filing-order-7",
    "originalQuery": "SELECT \n  c.COVERAGE_ID,\n  c.PAYOR_ID_PAYOR_NAME as payor,\n  \n  -- Cost sharing from COVERAGE table\n  c.ECD_TABLE_DEF_COPAY as copay_structure,\n  c.COINSURANCE_OVR as coinsurance_override,\n  \n  -- Member-specific information\n  cm.MEM_COVERED_YN as coverage_verified\n  \nFROM COVERAGE c\nJOIN COVERAGE_MEMBER_LIST cm ON c.COVERAGE_ID = cm.COVERAGE_ID\nWHERE cm.PAT_ID = 'Z7004242';",
    "description": "Extract cost sharing information from coverage",
    "chapterId": "04.4-coverage-and-filing-order",
    "index": 7,
    "results": [
      {
        "COVERAGE_ID": 5934765,
        "payor": "BLUE CROSS OF WISCONSIN",
        "copay_structure": "",
        "coinsurance_override": "",
        "coverage_verified": "Y"
      }
    ],
    "columns": [
      "COVERAGE_ID",
      "payor",
      "copay_structure",
      "coinsurance_override",
      "coverage_verified"
    ],
    "error": null
  },
  {
    "id": "04.4-coverage-and-filing-order-8",
    "originalQuery": "SELECT DISTINCT\n  c.GROUP_NAME,\n  c.GROUP_NUM,\n  c.PAYOR_ID_PAYOR_NAME,\n  COUNT(DISTINCT cm.PAT_ID) as covered_members\nFROM COVERAGE c\nJOIN COVERAGE_MEMBER_LIST cm ON c.COVERAGE_ID = cm.COVERAGE_ID\nWHERE c.GROUP_NAME IS NOT NULL\nGROUP BY c.GROUP_NAME, c.GROUP_NUM, c.PAYOR_ID_PAYOR_NAME\nORDER BY covered_members DESC;",
    "description": "Explore group coverage structures",
    "chapterId": "04.4-coverage-and-filing-order",
    "index": 8,
    "results": [
      {
        "GROUP_NAME": "Microsoft",
        "GROUP_NUM": 1000010,
        "PAYOR_ID_PAYOR_NAME": "BLUE CROSS OF WISCONSIN",
        "covered_members": 1
      }
    ],
    "columns": [
      "GROUP_NAME",
      "GROUP_NUM",
      "PAYOR_ID_PAYOR_NAME",
      "covered_members"
    ],
    "error": null
  }
]