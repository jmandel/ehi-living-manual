[
  {
    "id": "02.6-history-and-audit-trails-0",
    "originalQuery": "-- History tables follow the naming pattern *_HX\nSELECT \n  COUNT(*) as history_table_count\nFROM sqlite_master \nWHERE type = 'table' \n  AND name LIKE '%_HX';",
    "description": "Count how many history tables exist in the export",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 0,
    "results": [
      {
        "history_table_count": 23
      }
    ],
    "columns": [
      "history_table_count"
    ],
    "error": null
  },
  {
    "id": "02.6-history-and-audit-trails-1",
    "originalQuery": "-- Look at PROBLEM_LIST_HX structure\n-- Note the PROBLEM_LIST_ID (entity) and LINE (version) columns\nSELECT \n  sql \nFROM sqlite_master \nWHERE type = 'table' \n  AND name = 'PROBLEM_LIST_HX';",
    "description": "Examine the structure of a typical history table",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 1,
    "results": [
      {
        "sql": "CREATE TABLE PROBLEM_LIST_HX (\n  -- This table contains data relating to the history of problems from patients' problem lists in the clinical system.\n  -- The unique ID of this Problem List entry.\n  PROBLEM_LIST_ID INTEGER,\n  -- Used to identify the particular problem within the historical problems\n  LINE INTEGER,\n  -- ID of the diagnosis associated with this historical problem\n  HX_PROBLEM_ID INTEGER,\n  -- The historical display name of the problem. Only contains data if the default display name is changed.\n  HX_DESCRIPTION TEXT,\n  -- Represents the historical value of the first possible date that a problem could have been noted/onset on.    A problem's noted date is documented as a fuzzy date, meaning that it can capture approximate date data (\"2012\", \"1/2012\") or exact data (\"3/5/2012\"). This column captures the earliest date of the effective range. See HX_NOTED_END_DATE for the latest counterpart. For example, if 2012 is documented in hyperspace, then HX_NOTED_DATE will be 1/1/2012 and HX_NOTED_END_DATE will be 12/31/2012.\n  HX_DATE_NOTED TEXT,\n  -- The date on which this problem was resolved.\n  HX_DATE_RESOLVED TEXT,\n  -- The historical preview text (first characters) of all the Overview notes entered for a Problem List entry.\n  HX_COMMENT TEXT,\n  -- The date that the problem was added to or updated on the patient's Problem List in calendar format.\n  HX_DATE_OF_ENTRY TEXT,\n  -- The name of the user record. This name may be hidden.\n  HX_ENTRY_USER_ID_NAME TEXT,\n  -- The ID of the user who edited this problem on the patient's Problem List. This ID may be encrypted.\n  HX_ENTRY_USER_ID TEXT,\n  -- Indicates this problem was visible on web based chart system when this historical action was recorded.\n  HX_MYCHART_YN TEXT,\n  -- This column indicates whether or not this problem was flagged as chronic as of this historical event.\n  HX_CHRONIC_YN TEXT,\n  -- This column indicates whether or not this problem was flagged as the principal problem as of this historical event.\n  HX_PRINCIPAL_YN TEXT,\n  -- This column indicates whether or not this problem was flagged as a hospital problem as of this historical event.\n  HX_IS_HOSP_YN TEXT,\n  -- Contact Serial Number (CSN) of the patient encounter where this historical problem list was documented.\n  HX_PROBLEM_EPT_CSN INTEGER,\n  -- The category value associated with the problem's state: Active, Resolved, or Deleted as of this historical event.\n  HX_STATUS_C_NAME TEXT,\n  -- The category value associated with the level of urgency of the problem at the time this history event was recorded.\n  HX_LEVEL_URGENCY_C_NAME TEXT,\n  -- The category value associated with the relative severity of the problem. Problems can be given a priority (e.g., \"high, medium, or low\" ).  This field shows the category value associated with the priority level assigned to a problem when this action was taken.\n  HX_PRIORITY_C_NAME TEXT,\n  -- The date and time when the problem was updated on the patient's problem list.\n  HX_ENTRY_INST TEXT,\n  -- This column has the history of the present on admission indicator, which indicates if a hospital problem was present on admission or not.\n  HX_PROBLEM_POA_C_NAME TEXT,\n  -- This column holds the history of all stages ever associated with this problem.\n  HX_STAGE_ID TEXT,\n  -- Represents the historical value of the last possible date that a problem could have been noted/onset on.    A problem's noted date is documented as a fuzzy date, meaning that it can capture approximate date data (\"2012\", \"1/2012\") or exact data (\"3/5/2012\"). This column captures the latest date of the effective range. See HX_NOTED_DATE for the latest counterpart. For example, if 2012 is documented in hyperspace, then HX_NOTED_DATE will be 1/1/2012 and HX_NOTED_END_DATE will be 12/31/2012.  Note that the value may be empty, even if HX_NOTED_DATE is populated\n  HX_NOTED_END_DATE TEXT,\n  -- Represents the earliest possible date that a problem could have been diagnosed on at a particular edit. The latest possible date is stored in HX_DIAG_END_DATE.  If these values are the same, then the date is exact rather than fuzzy. For a problem or condition affecting a patient, the diagnosis date is defined as the date when a qualified professional first recognized the presence of that condition with sufficient certainty, regardless of whether it was fully characterized at that time. For diseases such as cancer, this may be the earliest date of a clinical diagnosis from before it was histologically confirmed, not the date of confirmation if that occurred later.\n  HX_DIAG_START_DATE TEXT,\n  HX_DIAG_END_DATE_ TEXT\n)"
      }
    ],
    "columns": [
      "sql"
    ],
    "error": null
  },
  {
    "id": "02.6-history-and-audit-trails-2",
    "originalQuery": "-- Watch a charge move through review stages\nSELECT \n  TX_ID,\n  LINE,\n  CR_HX_DATE as change_date,\n  CR_HX_TIME as change_time,\n  CR_HX_USER_ID_NAME as changed_by,\n  CR_HX_ACTIVITY_C_NAME as activity\nFROM ARPB_TX_CHG_REV_HX\nWHERE TX_ID = 129124216\nORDER BY LINE;",
    "description": "See how LINE tracks charge review workflow",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 2,
    "results": [
      {
        "TX_ID": 129124216,
        "LINE": 1,
        "change_date": "8/10/2018 12:00:00 AM",
        "change_time": "1/1/1900 10:45:00 AM",
        "changed_by": "EDI, FINANCIAL TRANSACTIONS IN",
        "activity": "Entry"
      },
      {
        "TX_ID": 129124216,
        "LINE": 2,
        "change_date": "8/13/2018 12:00:00 AM",
        "change_time": "1/1/1900 3:29:00 PM",
        "changed_by": "BRIGGS, BECKY",
        "activity": "Review"
      },
      {
        "TX_ID": 129124216,
        "LINE": 3,
        "change_date": "8/13/2018 12:00:00 AM",
        "change_time": "1/1/1900 3:29:00 PM",
        "changed_by": "BRIGGS, BECKY",
        "activity": "Resubmit"
      }
    ],
    "columns": [
      "TX_ID",
      "LINE",
      "change_date",
      "change_time",
      "changed_by",
      "activity"
    ],
    "error": null
  },
  {
    "id": "02.6-history-and-audit-trails-3",
    "originalQuery": "-- See how a patient's address evolved\nSELECT \n  PAT_ID,\n  LINE,\n  EFF_START_DATE,\n  EFF_END_DATE,\n  ADDR_HX_LINE1,\n  CITY_HX,\n  ADDR_CHNG_SOURCE_C_NAME as change_source\nFROM PAT_ADDR_CHNG_HX\nWHERE PAT_ID = 'Z7004242'\nORDER BY LINE;",
    "description": "Track address changes for a patient",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 3,
    "results": [
      {
        "PAT_ID": "Z7004242",
        "LINE": 1,
        "EFF_START_DATE": "7/17/2018 12:00:00 AM",
        "EFF_END_DATE": "8/9/2018 12:00:00 AM",
        "ADDR_HX_LINE1": "REDACTED",
        "CITY_HX": "MADISON",
        "change_source": "Cadence"
      },
      {
        "PAT_ID": "Z7004242",
        "LINE": 2,
        "EFF_START_DATE": "8/9/2018 12:00:00 AM",
        "EFF_END_DATE": "",
        "ADDR_HX_LINE1": "REDACTED",
        "CITY_HX": "MADISON",
        "change_source": "Cadence"
      }
    ],
    "columns": [
      "PAT_ID",
      "LINE",
      "EFF_START_DATE",
      "EFF_END_DATE",
      "ADDR_HX_LINE1",
      "CITY_HX",
      "change_source"
    ],
    "error": null
  },
  {
    "id": "02.6-history-and-audit-trails-4",
    "originalQuery": "-- Modern approach using ROW_NUMBER()\nWITH RankedHistory AS (\n  SELECT \n    *,\n    ROW_NUMBER() OVER (\n      PARTITION BY PROBLEM_LIST_ID \n      ORDER BY LINE DESC\n    ) as rn\n  FROM PROBLEM_LIST_HX\n)\nSELECT \n  PROBLEM_LIST_ID,\n  LINE,\n  HX_DATE_OF_ENTRY,\n  HX_STATUS_C_NAME,\n  HX_DESCRIPTION\nFROM RankedHistory \nWHERE rn = 1;",
    "description": "Find current state from history using window functions",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 4,
    "results": [
      {
        "PROBLEM_LIST_ID": 30694847,
        "LINE": 1,
        "HX_DATE_OF_ENTRY": "8/9/2018 12:00:00 AM",
        "HX_STATUS_C_NAME": "Active",
        "HX_DESCRIPTION": ""
      },
      {
        "PROBLEM_LIST_ID": 90574164,
        "LINE": 1,
        "HX_DATE_OF_ENTRY": "8/29/2022 12:00:00 AM",
        "HX_STATUS_C_NAME": "Active",
        "HX_DESCRIPTION": ""
      }
    ],
    "columns": [
      "PROBLEM_LIST_ID",
      "LINE",
      "HX_DATE_OF_ENTRY",
      "HX_STATUS_C_NAME",
      "HX_DESCRIPTION"
    ],
    "error": null
  },
  {
    "id": "02.6-history-and-audit-trails-5",
    "originalQuery": "-- Which charges required the most review cycles?\nSELECT \n  TX_ID,\n  COUNT(*) as review_count,\n  MIN(CR_HX_DATE) as first_review,\n  MAX(CR_HX_DATE) as last_review,\n  COUNT(DISTINCT CR_HX_USER_ID_NAME) as reviewers\nFROM ARPB_TX_CHG_REV_HX\nWHERE CR_HX_USER_ID_NAME IS NOT NULL\nGROUP BY TX_ID\nHAVING COUNT(*) > 2\nORDER BY review_count DESC\nLIMIT 10;",
    "description": "Find charges that went through multiple reviews",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 5,
    "results": [
      {
        "TX_ID": 213432121,
        "review_count": 6,
        "first_review": "",
        "last_review": "8/13/2020 12:00:00 AM",
        "reviewers": 4
      },
      {
        "TX_ID": 129124339,
        "review_count": 4,
        "first_review": "",
        "last_review": "8/9/2018 12:00:00 AM",
        "reviewers": 3
      },
      {
        "TX_ID": 355871699,
        "review_count": 3,
        "first_review": "10/12/2023 12:00:00 AM",
        "last_review": "10/3/2023 12:00:00 AM",
        "reviewers": 2
      },
      {
        "TX_ID": 328283034,
        "review_count": 3,
        "first_review": "3/10/2023 12:00:00 AM",
        "last_review": "3/7/2023 12:00:00 AM",
        "reviewers": 2
      },
      {
        "TX_ID": 317236398,
        "review_count": 3,
        "first_review": "12/20/2022 12:00:00 AM",
        "last_review": "12/20/2022 12:00:00 AM",
        "reviewers": 1
      },
      {
        "TX_ID": 315026147,
        "review_count": 3,
        "first_review": "12/6/2022 12:00:00 AM",
        "last_review": "12/6/2022 12:00:00 AM",
        "reviewers": 2
      },
      {
        "TX_ID": 302968775,
        "review_count": 3,
        "first_review": "9/1/2022 12:00:00 AM",
        "last_review": "9/22/2022 12:00:00 AM",
        "reviewers": 2
      },
      {
        "TX_ID": 302968774,
        "review_count": 3,
        "first_review": "9/1/2022 12:00:00 AM",
        "last_review": "9/22/2022 12:00:00 AM",
        "reviewers": 2
      },
      {
        "TX_ID": 302543307,
        "review_count": 3,
        "first_review": "9/1/2022 12:00:00 AM",
        "last_review": "9/20/2022 12:00:00 AM",
        "reviewers": 2
      },
      {
        "TX_ID": 302543306,
        "review_count": 3,
        "first_review": "9/1/2022 12:00:00 AM",
        "last_review": "9/20/2022 12:00:00 AM",
        "reviewers": 2
      }
    ],
    "columns": [
      "TX_ID",
      "review_count",
      "first_review",
      "last_review",
      "reviewers"
    ],
    "error": null
  },
  {
    "id": "02.6-history-and-audit-trails-6",
    "originalQuery": "-- See voided charges and who voided them\nSELECT \n  TX_ID,\n  DEL_REVERSE_DATE as void_date,\n  DEL_CHARGE_USER_ID_NAME as voided_by,\n  VOID_REASON_C_NAME as void_reason\nFROM ARPB_TX_VOID\nWHERE DEL_REVERSE_DATE IS NOT NULL\nLIMIT 10;",
    "description": "Find voided transactions with reasons",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 6,
    "results": [
      {
        "TX_ID": 317236398,
        "void_date": "",
        "voided_by": "",
        "void_reason": ""
      },
      {
        "TX_ID": 315026147,
        "void_date": "12/20/2022 12:00:00 AM",
        "voided_by": "HIRZY, HEIDI L",
        "void_reason": ""
      }
    ],
    "columns": [
      "TX_ID",
      "void_date",
      "voided_by",
      "void_reason"
    ],
    "error": null
  },
  {
    "id": "02.6-history-and-audit-trails-7",
    "originalQuery": "-- See different change sources\nSELECT \n  CR_HX_USER_ID_NAME as change_source,\n  COUNT(*) as change_count,\n  CASE \n    WHEN CR_HX_USER_ID_NAME LIKE '%INTERFACE%' THEN 'System'\n    WHEN CR_HX_USER_ID_NAME LIKE '%EDI%' THEN 'System'\n    WHEN CR_HX_USER_ID_NAME LIKE '%BATCH%' THEN 'System'\n    ELSE 'User'\n  END as source_type\nFROM ARPB_TX_CHG_REV_HX\nWHERE CR_HX_USER_ID_NAME IS NOT NULL\nGROUP BY CR_HX_USER_ID_NAME\nORDER BY change_count DESC;",
    "description": "Identify system-generated vs user changes",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 7,
    "results": [
      {
        "change_source": "BRIGGS, BECKY",
        "change_count": 12,
        "source_type": "User"
      },
      {
        "change_source": "HIRZY, HEIDI L",
        "change_count": 9,
        "source_type": "User"
      },
      {
        "change_source": "RAMMELKAMP, ZOE L",
        "change_count": 5,
        "source_type": "User"
      },
      {
        "change_source": "MAIER, LISA M",
        "change_count": 4,
        "source_type": "User"
      },
      {
        "change_source": "EDI, FINANCIAL TRANSACTIONS IN",
        "change_count": 4,
        "source_type": "System"
      },
      {
        "change_source": "MILLER, JODI L",
        "change_count": 3,
        "source_type": "User"
      },
      {
        "change_source": "",
        "change_count": 3,
        "source_type": "User"
      },
      {
        "change_source": "SMITH, MARY B",
        "change_count": 2,
        "source_type": "User"
      },
      {
        "change_source": "DHILLON, PUNEET S",
        "change_count": 2,
        "source_type": "User"
      },
      {
        "change_source": "BRANDNER, JESSICA M",
        "change_count": 2,
        "source_type": "User"
      },
      {
        "change_source": "PICONE, MARY A",
        "change_count": 1,
        "source_type": "User"
      }
    ],
    "columns": [
      "change_source",
      "change_count",
      "source_type"
    ],
    "error": null
  },
  {
    "id": "02.6-history-and-audit-trails-8",
    "originalQuery": "-- Patient address change audit report\nSELECT \n  p.PAT_NAME,\n  p.PAT_MRN_ID,\n  h.LINE as version,\n  h.EFF_START_DATE as changed_on,\n  h.ADDR_HX_LINE1 as new_address,\n  h.CITY_HX as new_city,\n  h.ADDR_CHNG_SOURCE_C_NAME as changed_via\nFROM PAT_ADDR_CHNG_HX h\nJOIN PATIENT p ON h.PAT_ID = p.PAT_ID\nWHERE h.EFF_START_DATE >= date('now', '-1 year')\nORDER BY p.PAT_ID, h.LINE;",
    "description": "Create a basic audit report for compliance",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 8,
    "results": [
      {
        "PAT_NAME": "MANDEL,JOSHUA C",
        "PAT_MRN_ID": "APL324672",
        "version": 1,
        "changed_on": "7/17/2018 12:00:00 AM",
        "new_address": "REDACTED",
        "new_city": "MADISON",
        "changed_via": "Cadence"
      },
      {
        "PAT_NAME": "MANDEL,JOSHUA C",
        "PAT_MRN_ID": "APL324672",
        "version": 2,
        "changed_on": "8/9/2018 12:00:00 AM",
        "new_address": "REDACTED",
        "new_city": "MADISON",
        "changed_via": "Cadence"
      }
    ],
    "columns": [
      "PAT_NAME",
      "PAT_MRN_ID",
      "version",
      "changed_on",
      "new_address",
      "new_city",
      "changed_via"
    ],
    "error": null
  },
  {
    "id": "02.6-history-and-audit-trails-9",
    "originalQuery": "-- Good: Uses index efficiently\nSELECT * \nFROM PROBLEM_LIST_HX \nWHERE PROBLEM_LIST_ID = 30694847\n  AND HX_DATE_OF_ENTRY >= '2024-01-01';\n\n-- Avoid: Full table scan\n-- SELECT * FROM PROBLEM_LIST_HX \n-- WHERE HX_DATE_OF_ENTRY >= '2024-01-01';",
    "description": "Efficient history query pattern",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 9,
    "results": [
      {
        "PROBLEM_LIST_ID": 30694847,
        "LINE": 1,
        "HX_PROBLEM_ID": 70859,
        "HX_DESCRIPTION": "",
        "HX_DATE_NOTED": "8/9/2018 12:00:00 AM",
        "HX_DATE_RESOLVED": "",
        "HX_COMMENT": "",
        "HX_DATE_OF_ENTRY": "8/9/2018 12:00:00 AM",
        "HX_ENTRY_USER_ID_NAME": "DHILLON, PUNEET S",
        "HX_ENTRY_USER_ID": "DHILLOPS",
        "HX_MYCHART_YN": "Y",
        "HX_CHRONIC_YN": "N",
        "HX_PRINCIPAL_YN": "N",
        "HX_IS_HOSP_YN": "N",
        "HX_PROBLEM_EPT_CSN": 720803470,
        "HX_STATUS_C_NAME": "Active",
        "HX_LEVEL_URGENCY_C_NAME": "",
        "HX_PRIORITY_C_NAME": "",
        "HX_ENTRY_INST": "8/9/2018 11:10:00 AM",
        "HX_PROBLEM_POA_C_NAME": "",
        "HX_STAGE_ID": "",
        "HX_NOTED_END_DATE": "",
        "HX_DIAG_START_DATE": "",
        "HX_DIAG_END_DATE_": "\r"
      }
    ],
    "columns": [
      "PROBLEM_LIST_ID",
      "LINE",
      "HX_PROBLEM_ID",
      "HX_DESCRIPTION",
      "HX_DATE_NOTED",
      "HX_DATE_RESOLVED",
      "HX_COMMENT",
      "HX_DATE_OF_ENTRY",
      "HX_ENTRY_USER_ID_NAME",
      "HX_ENTRY_USER_ID",
      "HX_MYCHART_YN",
      "HX_CHRONIC_YN",
      "HX_PRINCIPAL_YN",
      "HX_IS_HOSP_YN",
      "HX_PROBLEM_EPT_CSN",
      "HX_STATUS_C_NAME",
      "HX_LEVEL_URGENCY_C_NAME",
      "HX_PRIORITY_C_NAME",
      "HX_ENTRY_INST",
      "HX_PROBLEM_POA_C_NAME",
      "HX_STAGE_ID",
      "HX_NOTED_END_DATE",
      "HX_DIAG_START_DATE",
      "HX_DIAG_END_DATE_"
    ],
    "error": null
  },
  {
    "id": "02.6-history-and-audit-trails-10",
    "originalQuery": "-- LINEs might have gaps - don't assume LINE = 2 follows LINE = 1\nWITH line_gaps AS (\n  SELECT \n    TX_ID,\n    LINE,\n    LAG(LINE) OVER (PARTITION BY TX_ID ORDER BY LINE) as prev_line,\n    LINE - LAG(LINE) OVER (PARTITION BY TX_ID ORDER BY LINE) as gap\n  FROM ARPB_TX_CHG_REV_HX\n)\nSELECT \n  TX_ID,\n  LINE,\n  prev_line,\n  gap\nFROM line_gaps\nWHERE gap > 1\nLIMIT 5;",
    "description": "Check for gaps in LINE sequences",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 10,
    "results": [],
    "columns": [],
    "error": null
  },
  {
    "id": "02.6-history-and-audit-trails-11",
    "originalQuery": "-- Compare parent vs history record counts\nSELECT \n  'PROBLEM_LIST' as table_type,\n  COUNT(*) as record_count\nFROM PROBLEM_LIST\nUNION ALL\nSELECT \n  'PROBLEM_LIST_HX',\n  COUNT(DISTINCT PROBLEM_LIST_ID)\nFROM PROBLEM_LIST_HX;",
    "description": "Find the relationship between parent and history tables",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 11,
    "results": [
      {
        "table_type": "PROBLEM_LIST",
        "record_count": 2
      },
      {
        "table_type": "PROBLEM_LIST_HX",
        "record_count": 2
      }
    ],
    "columns": [
      "table_type",
      "record_count"
    ],
    "error": null
  },
  {
    "id": "02.6-history-and-audit-trails-12",
    "originalQuery": "-- Phone number change history is tracked in dedicated history tables\nSELECT \n  ACCOUNT_ID,\n  PHONE_NUMBER,\n  CHANGE_DATE,\n  CHANGE_SOURCE_C_NAME_ as change_source\nFROM ACCT_HOME_PHONE_HX\nORDER BY CHANGE_DATE DESC;\n-- This shows how Epic tracks historical values when phone numbers change",
    "description": "View phone number history tracking",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 12,
    "results": [
      {
        "ACCOUNT_ID": 1810018166,
        "PHONE_NUMBER": "617-894-1015",
        "CHANGE_DATE": "11/14/2022 12:00:00 AM",
        "change_source": "Chronicles\r"
      },
      {
        "ACCOUNT_ID": 4793998,
        "PHONE_NUMBER": "617-894-1015",
        "CHANGE_DATE": "11/14/2022 12:00:00 AM",
        "change_source": "Chronicles"
      }
    ],
    "columns": [
      "ACCOUNT_ID",
      "PHONE_NUMBER",
      "CHANGE_DATE",
      "change_source"
    ],
    "error": null
  },
  {
    "id": "02.6-history-and-audit-trails-13",
    "originalQuery": "-- Summary of history table activity\nSELECT \n  'PAT_ADDR_CHNG_HX' as history_table,\n  COUNT(*) as total_changes,\n  COUNT(DISTINCT PAT_ID) as entities_changed,\n  ROUND(CAST(COUNT(*) AS FLOAT) / COUNT(DISTINCT PAT_ID), 2) as avg_changes_per_entity\nFROM PAT_ADDR_CHNG_HX\nUNION ALL\nSELECT \n  'PROBLEM_LIST_HX',\n  COUNT(*),\n  COUNT(DISTINCT PROBLEM_LIST_ID),\n  ROUND(CAST(COUNT(*) AS FLOAT) / COUNT(DISTINCT PROBLEM_LIST_ID), 2)\nFROM PROBLEM_LIST_HX\nUNION ALL\nSELECT \n  'ARPB_TX_CHG_REV_HX',\n  COUNT(*),\n  COUNT(DISTINCT TX_ID),\n  ROUND(CAST(COUNT(*) AS FLOAT) / COUNT(DISTINCT TX_ID), 2)\nFROM ARPB_TX_CHG_REV_HX;",
    "description": "Analyze change patterns across history tables",
    "chapterId": "02.6-history-and-audit-trails",
    "index": 13,
    "results": [
      {
        "history_table": "PAT_ADDR_CHNG_HX",
        "total_changes": 2,
        "entities_changed": 1,
        "avg_changes_per_entity": 2
      },
      {
        "history_table": "PROBLEM_LIST_HX",
        "total_changes": 2,
        "entities_changed": 2,
        "avg_changes_per_entity": 1
      },
      {
        "history_table": "ARPB_TX_CHG_REV_HX",
        "total_changes": 47,
        "entities_changed": 15,
        "avg_changes_per_entity": 3.13
      }
    ],
    "columns": [
      "history_table",
      "total_changes",
      "entities_changed",
      "avg_changes_per_entity"
    ],
    "error": null
  }
]