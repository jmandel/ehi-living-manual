[
  {
    "id": "04.1-hospital-vs-professional-billing-0",
    "originalQuery": "SELECT \n  'Hospital Billing (HSP)' as billing_type,\n  COUNT(*) as table_count\nFROM sqlite_master \nWHERE type='table' AND name LIKE 'HSP_%'\n\nUNION ALL\n\nSELECT \n  'Professional Billing (ARPB)',\n  COUNT(*)\nFROM sqlite_master\nWHERE type='table' AND name LIKE 'ARPB_%';",
    "description": "Count records in hospital vs professional billing systems",
    "chapterId": "04.1-hospital-vs-professional-billing",
    "index": 0,
    "results": [
      {
        "billing_type": "Hospital Billing (HSP)",
        "table_count": 52
      },
      {
        "billing_type": "Professional Billing (ARPB)",
        "table_count": 15
      }
    ],
    "columns": [
      "billing_type",
      "table_count"
    ],
    "error": null
  },
  {
    "id": "04.1-hospital-vs-professional-billing-1",
    "originalQuery": "SELECT \n  HSP_ACCOUNT_ID,\n  HSP_ACCOUNT_NAME,\n  ADM_DATE_TIME as admission_date,\n  DISCH_DATE_TIME as discharge_date,\n  TOT_CHGS as total_charges,\n  ACCT_BILLSTS_HA_C_NAME as billing_status\nFROM HSP_ACCOUNT\nORDER BY TOT_CHGS DESC;",
    "description": "See hospital accounts with their total charges",
    "chapterId": "04.1-hospital-vs-professional-billing",
    "index": 1,
    "results": [
      {
        "HSP_ACCOUNT_ID": 376684810,
        "HSP_ACCOUNT_NAME": "MANDEL,JOSHUA C",
        "admission_date": "3/11/2022 2:41:00 PM",
        "discharge_date": "3/31/2022 12:00:00 AM",
        "total_charges": 1638.82,
        "billing_status": "Closed"
      },
      {
        "HSP_ACCOUNT_ID": 377811219,
        "HSP_ACCOUNT_NAME": "MANDEL,JOSHUA C",
        "admission_date": "3/22/2022 4:42:00 PM",
        "discharge_date": "3/22/2022 11:59:00 PM",
        "total_charges": null,
        "billing_status": "Closed"
      },
      {
        "HSP_ACCOUNT_ID": 376684703,
        "HSP_ACCOUNT_NAME": "MANDEL,JOSHUA C",
        "admission_date": "",
        "discharge_date": "",
        "total_charges": null,
        "billing_status": "Billed"
      },
      {
        "HSP_ACCOUNT_ID": 377515141,
        "HSP_ACCOUNT_NAME": "MANDEL,JOSHUA C",
        "admission_date": "3/11/2022 2:41:00 PM",
        "discharge_date": "3/11/2022 11:59:00 PM",
        "total_charges": null,
        "billing_status": "Closed"
      }
    ],
    "columns": [
      "HSP_ACCOUNT_ID",
      "HSP_ACCOUNT_NAME",
      "admission_date",
      "discharge_date",
      "total_charges",
      "billing_status"
    ],
    "error": null
  },
  {
    "id": "04.1-hospital-vs-professional-billing-2",
    "originalQuery": "SELECT \n  pe.PAT_ENC_CSN_ID,\n  pe.CONTACT_DATE,\n  pe.HSP_ACCOUNT_ID,\n  ha.TOT_CHGS as hospital_charges,\n  ha.ACCT_BILLSTS_HA_C_NAME as billing_status\nFROM PAT_ENC pe\nINNER JOIN HSP_ACCOUNT ha \n  ON pe.HSP_ACCOUNT_ID = ha.HSP_ACCOUNT_ID\nWHERE pe.HSP_ACCOUNT_ID IS NOT NULL;",
    "description": "Connect encounters to their hospital accounts",
    "chapterId": "04.1-hospital-vs-professional-billing",
    "index": 2,
    "results": [
      {
        "PAT_ENC_CSN_ID": 922942674,
        "CONTACT_DATE": "3/11/2022 12:00:00 AM",
        "HSP_ACCOUNT_ID": 376684810,
        "hospital_charges": 1638.82,
        "billing_status": "Closed"
      },
      {
        "PAT_ENC_CSN_ID": 922943112,
        "CONTACT_DATE": "3/22/2022 12:00:00 AM",
        "HSP_ACCOUNT_ID": 376684810,
        "hospital_charges": 1638.82,
        "billing_status": "Closed"
      }
    ],
    "columns": [
      "PAT_ENC_CSN_ID",
      "CONTACT_DATE",
      "HSP_ACCOUNT_ID",
      "hospital_charges",
      "billing_status"
    ],
    "error": null
  },
  {
    "id": "04.1-hospital-vs-professional-billing-3",
    "originalQuery": "SELECT \n  ht.HSP_ACCOUNT_ID,\n  ht.SERVICE_DATE,\n  ht.UB_REV_CODE_ID,\n  ht.UB_REV_CODE_ID_REVENUE_CODE_NAME as revenue_code,\n  ht.TX_AMOUNT as charge_amount,\n  ht.TX_TYPE_HA_C_NAME as transaction_type\nFROM HSP_TRANSACTIONS ht\nWHERE ht.TX_TYPE_HA_C_NAME LIKE '%Charge%'\n  AND ht.TX_AMOUNT > 0\nORDER BY ht.SERVICE_DATE DESC\nLIMIT 20;",
    "description": "Explore hospital charges and their revenue codes",
    "chapterId": "04.1-hospital-vs-professional-billing",
    "index": 3,
    "results": [
      {
        "HSP_ACCOUNT_ID": 376684810,
        "SERVICE_DATE": "3/22/2022 12:00:00 AM",
        "UB_REV_CODE_ID": 430,
        "revenue_code": "OCCUPATIONAL THERAPY - GENERAL CLASSIFICATION",
        "charge_amount": 865.08,
        "transaction_type": "Charge"
      },
      {
        "HSP_ACCOUNT_ID": 376684810,
        "SERVICE_DATE": "3/11/2022 12:00:00 AM",
        "UB_REV_CODE_ID": 434,
        "revenue_code": "OCCUPATIONAL THERAPY - EVALUATION OR REEVALUATION",
        "charge_amount": 557.47,
        "transaction_type": "Charge"
      },
      {
        "HSP_ACCOUNT_ID": 376684810,
        "SERVICE_DATE": "3/11/2022 12:00:00 AM",
        "UB_REV_CODE_ID": 430,
        "revenue_code": "OCCUPATIONAL THERAPY - GENERAL CLASSIFICATION",
        "charge_amount": 216.27,
        "transaction_type": "Charge"
      }
    ],
    "columns": [
      "HSP_ACCOUNT_ID",
      "SERVICE_DATE",
      "UB_REV_CODE_ID",
      "revenue_code",
      "charge_amount",
      "transaction_type"
    ],
    "error": null
  },
  {
    "id": "04.1-hospital-vs-professional-billing-4",
    "originalQuery": "SELECT \n  TX_TYPE_C_NAME as transaction_type,\n  COUNT(*) as count,\n  SUM(CASE WHEN DEBIT_CREDIT_FLAG_NAME = 'Debit' THEN AMOUNT ELSE -AMOUNT END) as net_amount\nFROM ARPB_TRANSACTIONS\nGROUP BY TX_TYPE_C_NAME\nORDER BY COUNT(*) DESC;",
    "description": "See the types of professional billing transactions",
    "chapterId": "04.1-hospital-vs-professional-billing",
    "index": 4,
    "results": [
      {
        "transaction_type": "Charge",
        "count": 18,
        "net_amount": 3013
      },
      {
        "transaction_type": "Payment",
        "count": 17,
        "net_amount": 1409.52
      },
      {
        "transaction_type": "Adjustment",
        "count": 17,
        "net_amount": 1288.48
      }
    ],
    "columns": [
      "transaction_type",
      "count",
      "net_amount"
    ],
    "error": null
  },
  {
    "id": "04.1-hospital-vs-professional-billing-5",
    "originalQuery": "SELECT \n  at.TX_ID,\n  at.SERVICE_DATE,\n  at.SERV_PROVIDER_ID,\n  at.DEPARTMENT_ID,\n  at.MODIFIER_ONE,\n  at.MODIFIER_TWO,\n  at.AMOUNT as charge_amount,\n  at.PROCEDURE_QUANTITY\nFROM ARPB_TRANSACTIONS at\nWHERE at.TX_TYPE_C_NAME = 'Charge'\nORDER BY at.SERVICE_DATE DESC\nLIMIT 10;",
    "description": "Examine professional charges in detail",
    "chapterId": "04.1-hospital-vs-professional-billing",
    "index": 5,
    "results": [
      {
        "TX_ID": 355871699,
        "SERVICE_DATE": "9/28/2023 12:00:00 AM",
        "SERV_PROVIDER_ID": 144590,
        "DEPARTMENT_ID": 1700801002,
        "MODIFIER_ONE": "25",
        "MODIFIER_TWO": "",
        "charge_amount": 330,
        "PROCEDURE_QUANTITY": 1
      },
      {
        "TX_ID": 354520701,
        "SERVICE_DATE": "9/28/2023 12:00:00 AM",
        "SERV_PROVIDER_ID": 621755,
        "DEPARTMENT_ID": 1700801002,
        "MODIFIER_ONE": "",
        "MODIFIER_TWO": "",
        "charge_amount": 60,
        "PROCEDURE_QUANTITY": 1
      },
      {
        "TX_ID": 354520699,
        "SERVICE_DATE": "9/28/2023 12:00:00 AM",
        "SERV_PROVIDER_ID": 621755,
        "DEPARTMENT_ID": 1700801002,
        "MODIFIER_ONE": "",
        "MODIFIER_TWO": "",
        "charge_amount": 54,
        "PROCEDURE_QUANTITY": 1
      },
      {
        "TX_ID": 354336210,
        "SERVICE_DATE": "9/28/2023 12:00:00 AM",
        "SERV_PROVIDER_ID": 144590,
        "DEPARTMENT_ID": 1700801005,
        "MODIFIER_ONE": "MCP",
        "MODIFIER_TWO": "",
        "charge_amount": 33,
        "PROCEDURE_QUANTITY": 1
      },
      {
        "TX_ID": 354336209,
        "SERVICE_DATE": "9/28/2023 12:00:00 AM",
        "SERV_PROVIDER_ID": 144590,
        "DEPARTMENT_ID": 1700801005,
        "MODIFIER_ONE": "MCP",
        "MODIFIER_TWO": "",
        "charge_amount": 120,
        "PROCEDURE_QUANTITY": 1
      },
      {
        "TX_ID": 354336208,
        "SERVICE_DATE": "9/28/2023 12:00:00 AM",
        "SERV_PROVIDER_ID": 144590,
        "DEPARTMENT_ID": 1700801005,
        "MODIFIER_ONE": "MCP",
        "MODIFIER_TWO": "",
        "charge_amount": 50,
        "PROCEDURE_QUANTITY": 1
      },
      {
        "TX_ID": 129124339,
        "SERVICE_DATE": "8/9/2018 12:00:00 AM",
        "SERV_PROVIDER_ID": 802011,
        "DEPARTMENT_ID": 1700801002,
        "MODIFIER_ONE": "",
        "MODIFIER_TWO": "",
        "charge_amount": 335,
        "PROCEDURE_QUANTITY": 1
      },
      {
        "TX_ID": 129124217,
        "SERVICE_DATE": "8/9/2018 12:00:00 AM",
        "SERV_PROVIDER_ID": 802011,
        "DEPARTMENT_ID": 1700801005,
        "MODIFIER_ONE": "MCP",
        "MODIFIER_TWO": "",
        "charge_amount": 37,
        "PROCEDURE_QUANTITY": 1
      },
      {
        "TX_ID": 129124216,
        "SERVICE_DATE": "8/9/2018 12:00:00 AM",
        "SERV_PROVIDER_ID": 802011,
        "DEPARTMENT_ID": 1700801005,
        "MODIFIER_ONE": "MCP",
        "MODIFIER_TWO": "",
        "charge_amount": 114,
        "PROCEDURE_QUANTITY": 1
      },
      {
        "TX_ID": 302543307,
        "SERVICE_DATE": "8/29/2022 12:00:00 AM",
        "SERV_PROVIDER_ID": 144590,
        "DEPARTMENT_ID": 1700801002,
        "MODIFIER_ONE": "25",
        "MODIFIER_TWO": "",
        "charge_amount": 222,
        "PROCEDURE_QUANTITY": 1
      }
    ],
    "columns": [
      "TX_ID",
      "SERVICE_DATE",
      "SERV_PROVIDER_ID",
      "DEPARTMENT_ID",
      "MODIFIER_ONE",
      "MODIFIER_TWO",
      "charge_amount",
      "PROCEDURE_QUANTITY"
    ],
    "error": null
  },
  {
    "id": "04.1-hospital-vs-professional-billing-6",
    "originalQuery": "SELECT \n  MODIFIER_ONE,\n  MODIFIER_TWO,\n  COUNT(*) as frequency,\n  AVG(AMOUNT) as avg_charge\nFROM ARPB_TRANSACTIONS\nWHERE TX_TYPE_C_NAME = 'Charge'\n  AND MODIFIER_ONE IS NOT NULL\nGROUP BY MODIFIER_ONE, MODIFIER_TWO\nORDER BY frequency DESC;",
    "description": "Analyze how modifiers affect billing",
    "chapterId": "04.1-hospital-vs-professional-billing",
    "index": 6,
    "results": [
      {
        "MODIFIER_ONE": "",
        "MODIFIER_TWO": "",
        "frequency": 8,
        "avg_charge": 220.5
      },
      {
        "MODIFIER_ONE": "MCP",
        "MODIFIER_TWO": "",
        "frequency": 7,
        "avg_charge": 75.28571428571429
      },
      {
        "MODIFIER_ONE": "25",
        "MODIFIER_TWO": "",
        "frequency": 2,
        "avg_charge": 276
      },
      {
        "MODIFIER_ONE": "95",
        "MODIFIER_TWO": "",
        "frequency": 1,
        "avg_charge": 170
      }
    ],
    "columns": [
      "MODIFIER_ONE",
      "MODIFIER_TWO",
      "frequency",
      "avg_charge"
    ],
    "error": null
  },
  {
    "id": "04.1-hospital-vs-professional-billing-7",
    "originalQuery": "-- Professional billing visits and their encounter links\nSELECT \n  av.PB_VISIT_ID,\n  av.PRIM_ENC_CSN_ID,\n  av.PB_TOTAL_CHARGES as professional_charges,\n  pe.HSP_ACCOUNT_ID,\n  CASE \n    WHEN pe.HSP_ACCOUNT_ID IS NOT NULL THEN 'Has Hospital Account'\n    ELSE 'Professional Only'\n  END as billing_scenario\nFROM ARPB_VISITS av\nLEFT JOIN PAT_ENC pe ON av.PRIM_ENC_CSN_ID = pe.PAT_ENC_CSN_ID\nORDER BY av.PB_TOTAL_CHARGES DESC;",
    "description": "Find encounters that could have both types of billing",
    "chapterId": "04.1-hospital-vs-professional-billing",
    "index": 7,
    "results": [
      {
        "PB_VISIT_ID": 9586039,
        "PRIM_ENC_CSN_ID": 948004323,
        "professional_charges": 516,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      },
      {
        "PB_VISIT_ID": 10686227,
        "PRIM_ENC_CSN_ID": 991225117,
        "professional_charges": 444,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      },
      {
        "PB_VISIT_ID": 4307370,
        "PRIM_ENC_CSN_ID": 720803470,
        "professional_charges": 335,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      },
      {
        "PB_VISIT_ID": 10141450,
        "PRIM_ENC_CSN_ID": 974614965,
        "professional_charges": 315,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      },
      {
        "PB_VISIT_ID": 10685743,
        "PRIM_ENC_CSN_ID": 958148810,
        "professional_charges": 226,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      },
      {
        "PB_VISIT_ID": 11825589,
        "PRIM_ENC_CSN_ID": 1028743701,
        "professional_charges": 203,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      },
      {
        "PB_VISIT_ID": 9587009,
        "PRIM_ENC_CSN_ID": 958147754,
        "professional_charges": 173,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      },
      {
        "PB_VISIT_ID": 6585418,
        "PRIM_ENC_CSN_ID": 829213099,
        "professional_charges": 170,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      },
      {
        "PB_VISIT_ID": 5960354,
        "PRIM_ENC_CSN_ID": 799951565,
        "professional_charges": 165,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      },
      {
        "PB_VISIT_ID": 4307813,
        "PRIM_ENC_CSN_ID": 724628999,
        "professional_charges": 151,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      },
      {
        "PB_VISIT_ID": 4334321,
        "PRIM_ENC_CSN_ID": 725327197,
        "professional_charges": null,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      },
      {
        "PB_VISIT_ID": 11825607,
        "PRIM_ENC_CSN_ID": 1028744231,
        "professional_charges": null,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      },
      {
        "PB_VISIT_ID": 11393498,
        "PRIM_ENC_CSN_ID": null,
        "professional_charges": null,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      },
      {
        "PB_VISIT_ID": 4307315,
        "PRIM_ENC_CSN_ID": null,
        "professional_charges": null,
        "HSP_ACCOUNT_ID": null,
        "billing_scenario": "Professional Only"
      }
    ],
    "columns": [
      "PB_VISIT_ID",
      "PRIM_ENC_CSN_ID",
      "professional_charges",
      "HSP_ACCOUNT_ID",
      "billing_scenario"
    ],
    "error": null
  },
  {
    "id": "04.1-hospital-vs-professional-billing-8",
    "originalQuery": "-- Hospital account statuses\nSELECT \n  'Hospital' as system,\n  ACCT_BILLSTS_HA_C_NAME as status,\n  COUNT(*) as count\nFROM HSP_ACCOUNT\nGROUP BY ACCT_BILLSTS_HA_C_NAME\n\nUNION ALL\n\n-- Professional billing statuses  \nSELECT \n  'Professional' as system,\n  PB_BILLING_STATUS_C_NAME,\n  COUNT(*)\nFROM ARPB_VISITS\nGROUP BY PB_BILLING_STATUS_C_NAME;",
    "description": "Check billing statuses in both systems",
    "chapterId": "04.1-hospital-vs-professional-billing",
    "index": 8,
    "results": [
      {
        "system": "Hospital",
        "status": "Billed",
        "count": 1
      },
      {
        "system": "Hospital",
        "status": "Closed",
        "count": 3
      },
      {
        "system": "Professional",
        "status": "Closed",
        "count": 13
      },
      {
        "system": "Professional",
        "status": "Open",
        "count": 1
      }
    ],
    "columns": [
      "system",
      "status",
      "count"
    ],
    "error": null
  },
  {
    "id": "04.1-hospital-vs-professional-billing-9",
    "originalQuery": "-- Hospital transactions: typically fewer, larger\nSELECT \n  'Hospital' as system,\n  TX_TYPE_HA_C_NAME as transaction_type,\n  COUNT(*) as count,\n  AVG(TX_AMOUNT) as avg_amount\nFROM HSP_TRANSACTIONS\nGROUP BY TX_TYPE_HA_C_NAME\n\nUNION ALL\n\n-- Professional transactions: many small line items\nSELECT \n  'Professional',\n  TX_TYPE_C_NAME,\n  COUNT(*),\n  AVG(AMOUNT)\nFROM ARPB_TRANSACTIONS\nGROUP BY TX_TYPE_C_NAME;",
    "description": "Compare transaction patterns",
    "chapterId": "04.1-hospital-vs-professional-billing",
    "index": 9,
    "results": [
      {
        "system": "Hospital",
        "transaction_type": "Charge",
        "count": 3,
        "avg_amount": 546.2733333333334
      },
      {
        "system": "Hospital",
        "transaction_type": "Credit Adjustment",
        "count": 3,
        "avg_amount": -1051.97
      },
      {
        "system": "Hospital",
        "transaction_type": "Debit Adjustment",
        "count": 2,
        "avg_amount": 1096.545
      },
      {
        "system": "Hospital",
        "transaction_type": "Payment",
        "count": 2,
        "avg_amount": -338
      },
      {
        "system": "Professional",
        "transaction_type": "Adjustment",
        "count": 17,
        "avg_amount": -75.79294117647059
      },
      {
        "system": "Professional",
        "transaction_type": "Charge",
        "count": 18,
        "avg_amount": 167.38888888888889
      },
      {
        "system": "Professional",
        "transaction_type": "Payment",
        "count": 17,
        "avg_amount": -82.91294117647058
      }
    ],
    "columns": [
      "system",
      "transaction_type",
      "count",
      "avg_amount"
    ],
    "error": null
  }
]