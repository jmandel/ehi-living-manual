# Chapter 4.1: Hospital vs. Professional Billing

*Purpose: Understand the two parallel financial worlds in Epic and why healthcare generates separate bills for facilities and providers.*

### The Two-Bill Reality

Picture this: You visit the emergency room for a broken arm. A month later, you receive *two* bills—one from the hospital for $5,000 and another from the emergency physician for $800. Why? Welcome to the fundamental split in healthcare billing.

**Hospital Billing** covers the "hotel" costs:
- Room and board
- Nursing care  
- Equipment and supplies
- Operating room time
- Medications from the hospital pharmacy

**Professional Billing** covers the "brain" costs:
- Physician services
- Interpretation of tests
- Surgical procedures (the surgeon's skill, not the OR)
- Consultations

This split exists for historical and regulatory reasons. Medicare established different payment systems for facilities versus physicians in the 1980s, and the entire industry aligned around this model.

---

### Recognizing the Split in Your Data

Epic implements this split through completely separate table families:

<example-query description="Count records in hospital vs professional billing systems">
SELECT 
  'Hospital Billing (HSP)' as billing_type,
  COUNT(*) as table_count
FROM sqlite_master 
WHERE type='table' AND name LIKE 'HSP_%'

UNION ALL

SELECT 
  'Professional Billing (ARPB)',
  COUNT(*)
FROM sqlite_master
WHERE type='table' AND name LIKE 'ARPB_%';
</example-query>

**Key Pattern**: 
- `HSP_*` tables = Hospital billing (HSP stands for Hospital System Patient)
- `ARPB_*` tables = Professional billing (ARPB stands for Accounts Receivable Professional Billing)

---

### Hospital Billing Deep Dive

#### The HAR: Your Financial Container

Every hospital stay or outpatient hospital visit creates a **HAR (Hospital Account Record)**. Think of it as a financial folder that collects all facility charges for that episode.

<example-query description="See hospital accounts with their total charges">
SELECT 
  HSP_ACCOUNT_ID,
  HSP_ACCOUNT_NAME,
  ADM_DATE_TIME as admission_date,
  DISCH_DATE_TIME as discharge_date,
  TOT_CHGS as total_charges,
  ACCT_BILLSTS_HA_C_NAME as billing_status
FROM HSP_ACCOUNT
ORDER BY TOT_CHGS DESC;
</example-query>

The HAR links back to the clinical encounter:

<example-query description="Connect encounters to their hospital accounts">
SELECT 
  pe.PAT_ENC_CSN_ID,
  pe.CONTACT_DATE,
  pe.HSP_ACCOUNT_ID,
  ha.TOT_CHGS as hospital_charges,
  ha.ACCT_BILLSTS_HA_C_NAME as billing_status
FROM PAT_ENC pe
INNER JOIN HSP_ACCOUNT ha 
  ON pe.HSP_ACCOUNT_ID = ha.HSP_ACCOUNT_ID
WHERE pe.HSP_ACCOUNT_ID IS NOT NULL;
</example-query>

#### Revenue Codes: The UB-04 Language

Hospital charges use **revenue codes**—standardized categories that appear on the UB-04 claim form (the standard hospital billing form).

<example-query description="Explore hospital charges and their revenue codes">
SELECT 
  ht.HSP_ACCOUNT_ID,
  ht.SERVICE_DATE,
  ht.UB_REV_CODE_ID,
  ht.UB_REV_CODE_ID_REVENUE_CODE_NAME as revenue_code,
  ht.TX_AMOUNT as charge_amount,
  ht.TX_TYPE_HA_C_NAME as transaction_type
FROM HSP_TRANSACTIONS ht
WHERE ht.TX_TYPE_HA_C_NAME LIKE '%Charge%'
  AND ht.TX_AMOUNT > 0
ORDER BY ht.SERVICE_DATE DESC
LIMIT 20;
</example-query>

Common revenue codes you'll see:
- **250-259**: Pharmacy
- **300-319**: Laboratory  
- **320-359**: Radiology
- **360-369**: Operating Room
- **450-459**: Emergency Room

#### The Bucket System

Epic's unique innovation for hospital billing is the **bucket** concept. Charges flow through "buckets" that represent who's responsible for payment at each stage.

While our sample database doesn't have bucket tables populated, the concept is critical:
1. **Pre-Billed Bucket**: Charges land here first
2. **Insurance Buckets**: One per payer (primary, secondary, etc.)
3. **Self-Pay Bucket**: Patient responsibility after insurance

---

### Professional Billing Deep Dive

#### Transactions: The Building Blocks

Professional billing uses a transaction-based model. Every charge, payment, and adjustment is a separate transaction linked by various keys.

<example-query description="See the types of professional billing transactions">
SELECT 
  TX_TYPE_C_NAME as transaction_type,
  COUNT(*) as count,
  SUM(CASE WHEN DEBIT_CREDIT_FLAG_NAME = 'Debit' THEN AMOUNT ELSE -AMOUNT END) as net_amount
FROM ARPB_TRANSACTIONS
GROUP BY TX_TYPE_C_NAME
ORDER BY COUNT(*) DESC;
</example-query>

<example-query description="Examine professional charges in detail">
SELECT 
  at.TX_ID,
  at.SERVICE_DATE,
  at.SERV_PROVIDER_ID,
  at.DEPARTMENT_ID,
  at.MODIFIER_ONE,
  at.MODIFIER_TWO,
  at.AMOUNT as charge_amount,
  at.PROCEDURE_QUANTITY
FROM ARPB_TRANSACTIONS at
WHERE at.TX_TYPE_C_NAME = 'Charge'
ORDER BY at.SERVICE_DATE DESC
LIMIT 10;
</example-query>

#### CPT Codes and Modifiers

Professional charges use **CPT codes** (Current Procedural Terminology) instead of revenue codes. These five-digit codes specify exactly what service was performed.

Modifiers add important context:
- **25**: Significant, separately identifiable E/M service
- **26**: Professional component only
- **TC**: Technical component only
- **59**: Distinct procedural service

<example-query description="Analyze how modifiers affect billing">
SELECT 
  MODIFIER_ONE,
  MODIFIER_TWO,
  COUNT(*) as frequency,
  AVG(AMOUNT) as avg_charge
FROM ARPB_TRANSACTIONS
WHERE TX_TYPE_C_NAME = 'Charge'
  AND MODIFIER_ONE IS NOT NULL
GROUP BY MODIFIER_ONE, MODIFIER_TWO
ORDER BY frequency DESC;
</example-query>

#### The CMS-1500 Form

Professional claims submit on the CMS-1500 form, which captures:
- Rendering provider (who did the work)
- Billing provider (who gets paid)  
- Place of service (office, hospital, etc.)
- Diagnosis codes linked to each CPT code
- Modifiers that affect payment

---

### Connecting the Two Worlds

Many encounters generate *both* hospital and professional charges. The key is understanding how they link:

<example-query description="Find encounters that could have both types of billing">
-- Professional billing visits and their encounter links
SELECT 
  av.PB_VISIT_ID,
  av.PRIM_ENC_CSN_ID,
  av.PB_TOTAL_CHARGES as professional_charges,
  pe.HSP_ACCOUNT_ID,
  CASE 
    WHEN pe.HSP_ACCOUNT_ID IS NOT NULL THEN 'Has Hospital Account'
    ELSE 'Professional Only'
  END as billing_scenario
FROM ARPB_VISITS av
LEFT JOIN PAT_ENC pe ON av.PRIM_ENC_CSN_ID = pe.PAT_ENC_CSN_ID
ORDER BY av.PB_TOTAL_CHARGES DESC;
</example-query>

#### Common Scenarios

**Emergency Room Visit**:
- Hospital bills for: ER room time, nursing, supplies
- Physician bills for: Medical evaluation and treatment

**Surgery**:
- Hospital bills for: OR time, anesthesia drugs, recovery room
- Surgeon bills for: Surgical procedure
- Anesthesiologist bills for: Anesthesia services

**Office Visit**: 
- Usually professional billing only
- Unless it's hospital-owned, then possible facility fee

---

### Working with Both Systems

#### Different Status Flows

Hospital and professional billing follow different status progressions:

<example-query description="Check billing statuses in both systems">
-- Hospital account statuses
SELECT 
  'Hospital' as system,
  ACCT_BILLSTS_HA_C_NAME as status,
  COUNT(*) as count
FROM HSP_ACCOUNT
GROUP BY ACCT_BILLSTS_HA_C_NAME

UNION ALL

-- Professional billing statuses  
SELECT 
  'Professional' as system,
  PB_BILLING_STATUS_C_NAME,
  COUNT(*)
FROM ARPB_VISITS
GROUP BY PB_BILLING_STATUS_C_NAME;
</example-query>

#### Payment Processing Differences

Hospital payments often come in bulk for the entire stay, while professional payments are line-by-line:

<example-query description="Compare transaction patterns">
-- Hospital transactions: typically fewer, larger
SELECT 
  'Hospital' as system,
  TX_TYPE_HA_C_NAME as transaction_type,
  COUNT(*) as count,
  AVG(TX_AMOUNT) as avg_amount
FROM HSP_TRANSACTIONS
GROUP BY TX_TYPE_HA_C_NAME

UNION ALL

-- Professional transactions: many small line items
SELECT 
  'Professional',
  TX_TYPE_C_NAME,
  COUNT(*),
  AVG(AMOUNT)
FROM ARPB_TRANSACTIONS
GROUP BY TX_TYPE_C_NAME;
</example-query>

---

### Key Takeaways

1. **Two separate worlds** exist in healthcare billing: facility (hospital) and professional (physician)
2. **Different forms**: Hospitals use UB-04, professionals use CMS-1500
3. **Different codes**: Revenue codes for hospitals, CPT codes for professionals
4. **Different tables**: `HSP_*` for hospital, `ARPB_*` for professional
5. **Same encounter** often generates charges in both systems
6. **Linking key**: Use CSN to connect clinical encounters to both billing systems
7. **Payment patterns**: Hospital payments are bundled, professional payments are line-by-line

Remember: When analyzing healthcare financials, always check *both* systems. Missing one means missing potentially half the picture.

---

### Next Steps
→ Continue to Chapter 4.2: Buckets & Transactions (HSP_)