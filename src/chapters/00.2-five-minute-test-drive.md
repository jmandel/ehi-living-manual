# Chapter 0.2: Five-Minute Test-Drive

*Purpose: Get your hands dirty with real Epic data immediately, proving you can query and understand this complex dataset right from your browser.*

### The Promise: Zero to Insight in Five Minutes

You've just been handed an Epic EHI export. Maybe it's thousands of files. Maybe you're feeling overwhelmed. Let's fix that—right now.

In the next five minutes, you'll run SQL queries against real Epic data. No setup. No installations. Just immediate results that prove you can master this dataset.

### What's Happening Behind the Scenes

When this page loaded, your browser:
1. Downloaded a small SQLite database containing real (redacted) Epic EHI data
2. Loaded it into memory using WebAssembly
3. Prepared an interactive SQL environment

Everything runs locally in your browser. Nothing to break. Nothing to configure.

### Your First Query: Meet PAT_ENC

The **patient encounter table** (`PAT_ENC`) is the beating heart of any Epic export. Every visit, every admission, every phone call creates an encounter record. Let's look at some:

<example-query description="View the first 5 patient encounters">
-- The PAT_ENC table: where everything begins
SELECT 
  PAT_ID,                -- The patient identifier
  PAT_ENC_CSN_ID,       -- The magic number: Contact Serial Number
  CONTACT_DATE,         -- When this happened
  APPT_STATUS_C_NAME    -- What kind of interaction
FROM PAT_ENC
LIMIT 5;
</example-query>

**What you're seeing:**
- `PAT_ID`: Links to the patient (in our sample, it's all one patient)
- `PAT_ENC_CSN_ID`: The **Contact Serial Number**—memorize this acronym. It's the key that unlocks everything.
- `CONTACT_DATE`: When the encounter occurred
- `APPT_STATUS_C_NAME`: The appointment status (Completed, Canceled, etc.)

### Your Second Query: Following the Thread

That CSN you just saw? It's the thread that weaves through the entire dataset. Let's use it to find what happened during a specific visit:

<example-query description="Find diagnoses for a specific encounter">
-- Join encounters with their diagnoses
SELECT 
  pe.PAT_ENC_CSN_ID,
  pe.APPT_STATUS_C_NAME as visit_status,
  ed.DX_NAME as diagnosis,
  dx.LINE as diagnosis_order
FROM PAT_ENC pe
JOIN PAT_ENC_DX dx ON pe.PAT_ENC_CSN_ID = dx.PAT_ENC_CSN_ID
JOIN CLARITY_EDG ed ON dx.DX_ID = ed.DX_ID
WHERE pe.PAT_ENC_CSN_ID = '720803470'
ORDER BY dx.LINE;
</example-query>

**Key Insight:** We just connected three tables using common IDs:
- `PAT_ENC` (the encounter)
- `PAT_ENC_DX` (diagnoses linked to encounters)
- `CLARITY_EDG` (the diagnosis master file with names)

The `LINE` field orders multiple diagnoses (1 = primary, 2 = secondary, etc.).

### Pattern Recognition: Epic's Design Philosophy

You've just discovered Epic's core pattern:
1. **Transaction tables** store events (`PAT_ENC`, `PAT_ENC_DX`)
2. **Master files** store definitions (`CLARITY_EDG`)
3. **IDs link everything** (`CSN`, `DX_ID`)

This pattern repeats everywhere: orders, medications, procedures, billing—always transactions pointing to master files.

### Quick Exploration: What Else Can We Find?

<example-query description="Count different appointment statuses">
-- What types of encounters are in our data?
SELECT 
  APPT_STATUS_C_NAME as status,
  COUNT(*) as count
FROM PAT_ENC
WHERE APPT_STATUS_C_NAME IS NOT NULL
GROUP BY APPT_STATUS_C_NAME
ORDER BY count DESC;
</example-query>

<example-query description="Find the 10 most common primary diagnoses">
-- What conditions appear most often?
SELECT 
  ed.DX_NAME as diagnosis,
  COUNT(*) as frequency
FROM PAT_ENC_DX dx
JOIN CLARITY_EDG ed ON dx.DX_ID = ed.DX_ID
WHERE dx.LINE = 1  -- Primary diagnosis only
GROUP BY ed.DX_NAME
ORDER BY frequency DESC
LIMIT 10;
</example-query>

<example-query description="Trace a patient's journey over time">
-- Follow the patient's encounters chronologically
SELECT 
  PAT_ENC_CSN_ID,
  CONTACT_DATE,
  APPT_STATUS_C_NAME,
  DEPARTMENT_ID
FROM PAT_ENC
WHERE PAT_ID = 'Z7004242'
  AND CONTACT_DATE IS NOT NULL
ORDER BY CONTACT_DATE DESC
LIMIT 10;
</example-query>

### The "Aha!" Moment

Look at what you just did:
- Found patient encounters
- Linked encounters to diagnoses
- Discovered master file relationships
- Analyzed patterns in the data

You didn't just view data—you navigated Epic's relational structure. The same queries that work on this one-patient sample will work on your million-patient export. The patterns are identical.

### Common Beginner Questions

**Q: Is this real patient data?**
A: Yes, this is a redacted version of an actual Epic export, shared publicly for education.

**Q: Why CSN and not just "ID"?**
A: Epic distinguishes between the patient (PAT_ID) and their visits (CSN). One patient, many encounters.

**Q: What's with the "C_NAME" suffix?**
A: Epic's convention for "category names"—human-readable values for coded fields.

**Q: Can I break anything?**
A: No! This is all read-only in your browser. Experiment freely.

### Your Five-Minute Achievement

In just five minutes, you've:
- ✓ Run SQL against real Epic data
- ✓ Understood the central role of CSN
- ✓ Joined multiple tables successfully
- ✓ Recognized Epic's core patterns
- ✓ Built confidence with hands-on experience

You're no longer staring at mysterious files. You're actively querying Epic data and getting answers.

### What's Next?

The patterns you just learned—CSN as the universal key, transaction tables pointing to master files, the `LINE` field for multiple values—these repeat throughout Epic's 18,000+ tables. Master these patterns, and you've mastered Epic data.

### Pro Tips for Going Further

1. **Follow the CSN**: When in doubt, search for PAT_ENC_CSN_ID
2. **Look for master files**: Tables starting with CLARITY_ often contain reference data
3. **Check for `_C_NAME` columns**: These translate codes to readable text
4. **Use `LINE` for ordering**: Multi-value fields use LINE numbers

### Download for Offline Work

Want to continue exploring with your own tools?

[Download sample_ehi.sqlite (3MB)](download-placeholder)

Compatible with:
- DB Browser for SQLite
- DBeaver
- Python (sqlite3/pandas)
- R (DBI/RSQLite)

---

### Key Takeaways

1. **CSN is king**: The Contact Serial Number links almost everything
2. **Patterns repeat**: Transaction tables + master files + ID links
3. **Start simple**: PAT_ENC is always your entry point
4. **Think in joins**: Epic data is highly normalized
5. **You can do this**: If you can write SQL, you can query Epic
